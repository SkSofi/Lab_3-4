<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebXR 3D Model Viewer</title>
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }
    
    #controls {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 15px;
      border-radius: 8px;
      z-index: 1000;
      max-width: 300px;
    }
    
    #controls h3 {
      margin: 0 0 10px 0;
      font-size: 16px;
    }
    
    #controls input[type="file"] {
      display: none;
    }
    
    #controls label {
      display: block;
      background: #4CAF50;
      color: white;
      padding: 10px;
      border-radius: 4px;
      cursor: pointer;
      text-align: center;
      margin-bottom: 10px;
    }
    
    #controls label:hover {
      background: #45a049;
    }
    
    #fileName {
      font-size: 12px;
      color: #aaa;
      margin-bottom: 10px;
      word-break: break-all;
    }
    
    .control-group {
      margin-bottom: 15px;
    }
    
    .control-group label {
      display: block;
      font-size: 12px;
      margin-bottom: 5px;
      background: none;
      padding: 0;
      cursor: default;
    }
    
    .control-group label:hover {
      background: none;
    }
    
    .control-group input[type="range"] {
      width: 100%;
    }
    
    .control-group button {
      background: #2196F3;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 4px;
      cursor: pointer;
      margin-right: 5px;
      margin-top: 5px;
    }
    
    .control-group button:hover {
      background: #0b7dda;
    }
    
    #info {
      font-size: 11px;
      color: #888;
      margin-top: 10px;
      line-height: 1.4;
    }
  </style>
</head>
<body>
  <div id="controls">
    <h3>üéÆ WebXR Viewer</h3>
    
    <input type="file" id="fileInput" accept=".glb,.gltf">
    <label for="fileInput">üìÅ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –º–æ–¥–µ–ª—å (.glb/.gltf)</label>
    
    <div id="fileName"></div>
    
    <div class="control-group">
      <label>–ú–∞—Å—à—Ç–∞–±: <span id="scaleValue">1</span></label>
      <input type="range" id="scaleSlider" min="0.1" max="5" step="0.1" value="1">
    </div>
    
    <div class="control-group">
      <label>–í–∏—Å–æ—Ç–∞: <span id="heightValue">0</span></label>
      <input type="range" id="heightSlider" min="-5" max="5" step="0.1" value="0">
    </div>
    
    <div class="control-group">
      <button id="resetBtn">üîÑ –°–∫–∏–Ω—É—Ç–∏</button>
      <button id="animBtn">‚ñ∂Ô∏è –ê–Ω—ñ–º–∞—Ü—ñ—è</button>
    </div>
    
    <div id="info">
      üí° –ö–µ—Ä—É–≤–∞–Ω–Ω—è:<br>
      ‚Ä¢ –ú–∏—à–∞: –æ–±–µ—Ä—Ç–∞–Ω–Ω—è –∫–∞–º–µ—Ä–∏<br>
      ‚Ä¢ WASD: –ø–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è<br>
      ‚Ä¢ VR –∫–Ω–æ–ø–∫–∞: —Ä–µ–∂–∏–º WebXR
    </div>
  </div>

  <a-scene>
    <!-- –ö–∞–º–µ—Ä–∞ –∑ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞–º–∏ -->
    <a-entity id="rig" position="0 1.6 3">
      <a-camera look-controls wasd-controls>
        <a-cursor></a-cursor>
      </a-camera>
    </a-entity>

    <!-- –û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è -->
    <a-light type="ambient" color="#BBB" intensity="0.5"></a-light>
    <a-light type="directional" color="#FFF" intensity="0.8" position="2 4 3"></a-light>
    <a-light type="point" color="#F4F4F4" intensity="0.3" position="-2 2 2"></a-light>

    <!-- –ú–æ–¥–µ–ª—å (–±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞ –¥–∏–Ω–∞–º—ñ—á–Ω–æ) -->
    <a-entity 
      id="model" 
      position="0 0 0" 
      scale="1 1 1"
      animation-mixer="clip: *"
      rotation="0 0 0">
    </a-entity>

    <!-- –ü—ñ–¥–ª–æ–≥–∞ –ø—Ä–∏–±—Ä–∞–Ω–∞ –¥–ª—è —á–∏—Å—Ç–æ–≥–æ –ø–µ—Ä–µ–≥–ª—è–¥—É -->

    <!-- –ù–µ–±–æ -->
    <a-sky color="#87CEEB"></a-sky>
  </a-scene>

  <script>
    const fileInput = document.getElementById('fileInput');
    const fileName = document.getElementById('fileName');
    const modelEntity = document.getElementById('model');
    const scaleSlider = document.getElementById('scaleSlider');
    const scaleValue = document.getElementById('scaleValue');
    const heightSlider = document.getElementById('heightSlider');
    const heightValue = document.getElementById('heightValue');
    const resetBtn = document.getElementById('resetBtn');
    const animBtn = document.getElementById('animBtn');
    
    let currentModelUrl = null;
    let animationEnabled = true;

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É
    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;

      // –í–∏–¥–∞–ª–µ–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó –º–æ–¥–µ–ª—ñ
      if (currentModelUrl) {
        URL.revokeObjectURL(currentModelUrl);
      }

      // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è URL –¥–ª—è –º–æ–¥–µ–ª—ñ
      currentModelUrl = URL.createObjectURL(file);
      fileName.textContent = `‚úì –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ: ${file.name}`;

      // –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –º–æ–¥–µ–ª—ñ
      modelEntity.setAttribute('gltf-model', currentModelUrl);
      
      // –°–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
      resetModel();
    });

    // –ö–æ–Ω—Ç—Ä–æ–ª—å –º–∞—Å—à—Ç–∞–±—É
    scaleSlider.addEventListener('input', (e) => {
      const scale = e.target.value;
      scaleValue.textContent = scale;
      modelEntity.setAttribute('scale', `${scale} ${scale} ${scale}`);
    });

    // –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–∏—Å–æ—Ç–∏
    heightSlider.addEventListener('input', (e) => {
      const height = e.target.value;
      heightValue.textContent = height;
      const pos = modelEntity.getAttribute('position');
      modelEntity.setAttribute('position', `${pos.x} ${height} ${pos.z}`);
    });

    // –°–∫–∏–¥–∞–Ω–Ω—è –º–æ–¥–µ–ª—ñ
    resetBtn.addEventListener('click', resetModel);

    function resetModel() {
      scaleSlider.value = 1;
      scaleValue.textContent = 1;
      heightSlider.value = 0;
      heightValue.textContent = 0;
      modelEntity.setAttribute('scale', '1 1 1');
      modelEntity.setAttribute('position', '0 0 0');
      modelEntity.setAttribute('rotation', '0 0 0');
    }

    // –ö–æ–Ω—Ç—Ä–æ–ª—å –∞–Ω—ñ–º–∞—Ü—ñ—ó
    animBtn.addEventListener('click', () => {
      animationEnabled = !animationEnabled;
      if (animationEnabled) {
        modelEntity.setAttribute('animation-mixer', 'clip: *');
        animBtn.textContent = '‚è∏Ô∏è –ü–∞—É–∑–∞';
      } else {
        modelEntity.removeAttribute('animation-mixer');
        animBtn.textContent = '‚ñ∂Ô∏è –ê–Ω—ñ–º–∞—Ü—ñ—è';
      }
    });
  </script>
</body>
</html>